/*!
 * 
 * easyteachlms
 * 
 * @author 
 * @version 3.0.0
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2020 
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackioeasyTeachLMSappJsonp=window.wpackioeasyTeachLMSappJsonp||[]).push([[0],{0:function(e,t){e.exports=React},139:function(e,t){e.exports=wp.domReady},141:function(e,t){e.exports=wp.url},15:function(e,t){e.exports=wp.element},16:function(e,t){e.exports=wp.data},165:function(e,t,a){a(166),e.exports=a(347)},167:function(e,t,a){},192:function(e,t){},29:function(e,t){e.exports=wp.apiFetch},347:function(e,t,a){"use strict";a.r(t);a(167);var n=a(139),c=a.n(n),r=a(140),o=a.n(r),l=a(16),u=a(15),i=a(141),s=a(61),d=a(357),m=a(358),p=function(e){var t=e.children;return React.createElement(u.Fragment,null,t)},f=a(36),h=a(29),E=a.n(h),g=a(354),v=a(355),R=a(356),y=window.userData,O=function(e){var t=e.uuid,a=e.userId,n=e.courseId,c=e.hasQuiz,r=e.isComplete,o=Object(u.useState)(!1),i=Object(f.a)(o,2),s=i[0],d=i[1],m=Object(l.useDispatch)("easyteachlms/course").setComplete;return React.createElement(g.a,{size:"small",color:r?"green":null,onClick:function(){d(!0),console.log("COURSE ID"),console.log(n),console.log(a),E()({path:"/easyteachlms/v3/student/update-progress/?userId=".concat(a,"&uuid=").concat(t,"&courseId=").concat(n),method:"POST",data:{completed:!0}}).then((function(e){console.log(e),setTimeout((function(){d(!1),m(t)}),1e3)}))},loading:s,disabled:r},"Mark Completed ",!0===c&&"(Requirement: Complete Quiz)")},b=function(e){var t=e.parentTitle,a=e.title,n=e.uuid,c=e.hasQuiz,r=e.className,o=e.children,i=Object(l.useSelect)((function(e){return{isComplete:e("easyteachlms/course").isComplete(n),isActive:e("easyteachlms/course").getActive()===n,courseId:e("easyteachlms/course").getCourseId()}}),[]),s=i.isComplete,d=i.isActive,m=i.courseId;if(!0!==d)return React.createElement(u.Fragment,null);var p=function(){var e=y.id;return React.createElement(v.a,{style:{fontSize:"14px"}},React.createElement(v.a.Item,null,React.createElement(O,{uuid:n,userId:e,courseId:m,hasQuiz:c,isComplete:s})),React.createElement(v.a.Item,null,"Get Help"))};return React.createElement(u.Fragment,null,React.createElement(R.a,{as:"h2",dividing:!0},a,!1!==t&&React.createElement(R.a.Subheader,null,t)),React.createElement("div",{className:r,"data-uuid":n},o,React.createElement(p,null)))},w=a(152),I=a.n(w),C=function(e){var t=e.uuid;console.log("QuizComponent"),console.log(t);var a=Object(l.useSelect)((function(e){var a=e("easyteachlms/course").getQuiz(t);console.log(a);var c=!1;return!1!==n&&(c=!0),{data:a,loaded:c}}),[t]),n=a.data,c=a.loaded;Object(s.a)((function(){console.log("QUIZ")}));return React.createElement("div",null,!1!==c&&React.createElement(I.a,{quiz:n,onComplete:function(e){console.log(e)}}))},z=function e(t,a,n,c){return u.Children.map(t,(function(t){if(!Object(u.isValidElement)(t))return React.createElement(u.RawHTML,null,t);t.props.children&&(t=Object(u.cloneElement)(t,{children:e(t.props.children,a,c)}));var n=t.props["data-uuid"],r=a.outline.flat.filter((function(e){return e.uuid===n})),o=!1,l=!1;r.length&&(o=r[0].parentTitle,l=r[0].hasQuiz);var i=t.props.className;return void 0===i?t:i.includes("wp-block-easyteachlms-topic")?React.createElement(b,{title:t.props["data-title"],className:t.props.className,uuid:n,parentTitle:o,hasQuiz:l},t):i.includes("wp-block-easyteachlms-quiz")?React.createElement(C,{uuid:n}):i.includes("wp-block-embed-youtube")?React.createElement("div",null,React.createElement(u.Fragment,null,t,React.createElement("hr",null))):React.createElement(p,null,t)}))},j=a(352),D=window.userData,A=function(e){var t=e.id,a=Object(l.useSelect)((function(e){var a=e("easyteachlms/course").getActive(),n=e("easyteachlms/course").getData(t),c=e("easyteachlms/course").getCompleted(),r=n.outline.total,o="".concat(c,"/").concat(r);return console.log("<Dashboard>"),console.log(n),console.log(e("easyteachlms/course").getQuizzes()),{data:n,isActive:"dashboard"===a,progress:c/r*100,progressRatio:o,files:e("easyteachlms/course").getFiles(),quizData:e("easyteachlms/course").getQuizzes()}}),[]),n=a.isActive,c=a.progress,r=a.progressRatio,o=a.files,i=a.quizData;if(!0!==n)return React.createElement(u.Fragment,null);var s=D.name,d=function(){return React.createElement(j.a,{percent:c,color:"teal",size:"small",active:!0,autoSuccess:!0},100===c?"Course Completed!":"Course Progress ".concat(r))},m=function(){console.info("<Files/>");var e=[];return o.forEach((function(t){e.push(React.createElement("li",null,React.createElement("a",{href:t.href,download:!0},t.title)))})),React.createElement(u.Fragment,null,React.createElement("h3",null,"Files"),React.createElement("p",null,React.createElement("i",null,"Click to download files")),React.createElement("ul",null,e))},p=function(){console.info("<Quizzes/>");var e=[];return i.forEach((function(t){e.push(React.createElement("li",null,React.createElement("a",null,t.quizTitle)))})),React.createElement(u.Fragment,null,React.createElement("h3",null,"Quizzes"),React.createElement("ul",null,e))};return React.createElement("div",null,React.createElement("h2",null,"Hi, ",s),React.createElement(d,null),React.createElement("p",null,"Course Description Here..."),React.createElement(p,null),React.createElement(m,null))},P=a(38),S=function(e){var t=e.title,a=e.uuid,n=Object(l.useDispatch)("easyteachlms/course").setActive,c=Object(l.useSelect)((function(e){return{isComplete:e("easyteachlms/course").isComplete(a),isActive:e("easyteachlms/course").getActive()===a}}),[]),r=c.isComplete,o=c.isActive;return React.createElement(v.a.Item,{onClick:function(){return n(a)},active:o},!0===r&&React.createElement(P.a,{name:"check circle"}),t)},T=function(e){var t=e.id,a=Object(l.useSelect)((function(e){var a=e("easyteachlms/course").getData(t),n=!1;return!1!==a&&(n=!0),{data:a,loaded:n}}),[]),n=a.data;if(!0===a.loaded){var c=n.outline.structured,r=[];for(var o in c){var u=c[o],i=u.title,s=u.outline,d=[];for(var m in s){var p=s[m].title;d.push(React.createElement(S,{title:p,uuid:m}))}r.push(React.createElement(v.a.Item,null,React.createElement(v.a.Header,null,i),React.createElement(v.a.Menu,null,d)))}return r}},F=function(e){var t=e.id,a=Object(l.useDispatch)("easyteachlms/course").setActive;return React.createElement(v.a,{vertical:!0,fluid:!0},React.createElement(v.a.Item,{onClick:function(){a("dashboard")}},"Course Dashboard"),React.createElement(T,{id:t}))},k=function(e){var t=e.courseId,a=window.userData.id,n=Object(u.useState)(!1),c=Object(f.a)(n,2),r=c[0],o=c[1],i=Object(l.useDispatch)("easyteachlms/course").enroll;return React.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},React.createElement("h1",null,"Not authorized"),React.createElement("p",null,"You are currently not enrolled in this course"),React.createElement(g.a,{primary:!0,onClick:function(){o(!0),E()({path:"/easyteachlms/v3/course/enroll/?userId=".concat(a,"&courseId=").concat(t),method:"POST",data:{enrolled:!0}}).then((function(e){console.log(e),setTimeout((function(){o(!1),i(!0)}),1e3)}))},loading:r},"Enroll"))},x={fetchFromAPI:function(e){return{type:"FETCH_FROM_API",courseId:e}},initDataFromAPI:function(e){return{type:"INIT_DATA",data:e}},setActive:function(e){var t=window,a=t.history,n=t.location,c=n.protocol,r=n.pathname,o=n.host;if(a.pushState){var l="".concat(c,"//").concat(o).concat(r,"?uuid=").concat(e);a.pushState({path:l},"",l)}return{type:"SET_ACTIVE",uuid:e}},enroll:function(e){return console.log("enroleld"),{type:"ENROLL",status:e}},setComplete:function(e){return{type:"SET_COMPLETE",uuid:e}}},Q={FETCH_FROM_API:function(e){var t=window.userData.id;return console.log("FETCH_FROM_API"),console.log(t),E()({path:"/easyteachlms/v3/course/get/?courseId=".concat(e.courseId,"&userId=").concat(t)})}},q={getUserId:function(e){return window.userData.id},getCourseId:function(e){return e.data.id},getActive:function(e){return e.active},getData:function(e,t){return console.log("selector::"),console.log("getData(".concat(t,")")),e.data},getQuiz:function(e,t){return!!e.data.hasOwnProperty("quizzes")&&e.data.quizzes.filter((function(e){return e.uuid===t}))[0]},getQuizzes:function(e){return!!e.data.hasOwnProperty("quizzes")&&e.data.quizzes},getFiles:function(e){return!!e.data.hasOwnProperty("files")&&e.data.files},getCompleted:function(e){return!(!e.data.hasOwnProperty("outline")||!e.data.outline.hasOwnProperty("completed"))&&e.data.outline.completed},isComplete:function(e,t){if(!e.data.hasOwnProperty("outline")||!e.data.outline.hasOwnProperty("flat"))return!1;var a=e.data.outline.flat,n=a.findIndex((function(e){return e.uuid===t}));return a[n].completed}},M=a(19);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){Object(M.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L={active:!1,completed:0,data:!1},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0,a=e.data;switch(t.type){case"INIT_DATA":return H(H({},e),{},{data:t.data});case"SET_ACTIVE":return H(H({},e),{},{active:t.uuid});case"ENROLL":return a.enrolled=t.status,H(H({},e),{},{data:a});case"SET_COMPLETE":var n=a.outline,c=n.flat,r=c.findIndex((function(e){return e.uuid===t.uuid}));return a.outline.flat[r].completed=!0,a.outline.completed=a.outline.completed+1,H(H({},e),{},{data:a})}return e},U=a(92),V=a.n(U),J={getData:V.a.mark((function e(t){var a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("resolvers"),console.log("getData(".concat(t,")")),e.next=4,x.fetchFromAPI(t);case 4:return a=e.sent,console.log(a),e.abrupt("return",x.initDataFromAPI(a));case 7:case"end":return e.stop()}}),e)}))},G=(Object(l.registerStore)("easyteachlms/course",{reducer:N,actions:x,selectors:q,controls:Q,resolvers:J}),function(e){var t=e.id,a=e.children,n=o()(a),c=Object(l.useDispatch)("easyteachlms/course").setActive,r=Object(l.useSelect)((function(e){var a=e("easyteachlms/course").getData(t);console.log(a);var n=!1;return!1!==a&&(n=!0),{data:a,loaded:n,isEnrolled:a.enrolled}}),[t]),p=r.data,f=r.loaded,h=r.isEnrolled;return Object(s.a)((function(){var e;e=Object(i.getQueryArg)(window.location.href,"uuid"),c(e||"dashboard")})),React.createElement(d.a,{loading:!f,style:{minHeight:"100px"}},!0===f&&!1===h&&React.createElement(k,{courseId:t}),!0===f&&!0===h&&React.createElement(m.a,{stackable:!0,divided:!0},React.createElement(m.a.Row,null,React.createElement(m.a.Column,{width:5},React.createElement(F,{id:t})),React.createElement(m.a.Column,{width:11},React.createElement(u.Fragment,null,React.createElement(A,{id:t}),z(n,p,"default"))))))});c()((function(){if(document.querySelector(".wp-block-easyteachlms-course")){document.querySelectorAll(".wp-block-easyteachlms-course").forEach((function(e){var t=parseInt(e.getAttribute("data-course-id")),a=e.innerHTML;Object(u.render)(React.createElement(G,{id:t,other:!1},a),e)}))}}))},45:function(e,t){e.exports=ReactDOM},92:function(e,t){e.exports=regeneratorRuntime}},[[165,1,2]]]);
//# sourceMappingURL=course-d625b61b.js.map