/*!
 * 
 * easyteachlms
 * 
 * @author 
 * @version 0.1.0
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2020 
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window["wpackioeasyTeachLMSlesson-blockJsonp"]=window["wpackioeasyTeachLMSlesson-blockJsonp"]||[]).push([[0],{0:function(e,t){e.exports=React},108:function(e,t){e.exports=lodash},16:function(e,t){e.exports=wp.i18n},186:function(e,t,n){n(187),e.exports=n(311)},188:function(e,t,n){},19:function(e,t){e.exports=wp.components},21:function(e,t){e.exports=wp.element},310:function(e,t,n){},311:function(e,t,n){"use strict";n.r(t);var a=n(173),l=n(48),c=n(16),i=n(53),o=n(21),s=n(4),r=n.n(s),d=n(322),u=(n(188),function(e){var t=e.title,n=e.postType,a=e.className,l=e.children,s=Object(o.useState)(!0),u=Object(i.a)(s,2),p=u[0],m=u[1],f=p?"down":"right";return React.createElement("div",{className:r()(a,{collapsed:!p})},React.createElement("div",{className:"collapsible-title"},React.createElement(d.a,{as:"h4",icon:"caret "+f,content:Object(c.__)(n.toUpperCase()+":  "+t),onClick:function(e){m(!p)}})),React.createElement("div",{className:"collapsible-content"},l))}),p=n(62),m=n(324),f=n(321),b=n(320),R=n(19),E=n(63),v=n(86),y=function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)},h=function(e,t,n,a){if(null==a)return!1;if(void 0===e||void 0===t||void 0===n)return!1;var c=y(n),i=new wp.api.models[c]({id:t});return new Promise((function(t){i.fetch().then((function(n){var c=Object(l.rawHandler)({HTML:n.content_raw});a(e,c).then((function(){t(n)}))}))}))},w=Object(m.a)({loading:!0,posts:[]})((function(e){var t=e.postType,n=e.loading,a=e.posts,l=e.setState,i=e.setAttributes,s=e.clientId,r=y(t),u=Object(E.useDispatch)("core/block-editor").replaceInnerBlocks;return Object(v.a)((function(){(new wp.api.collections[r]).fetch({data:{status:["publish","draft"]}}).then((function(e){var t=[];e.map((function(e){t.push({key:e.id,value:e.id,text:e.title.rendered})})),l({posts:t,loading:!1})}))})),React.createElement(o.Fragment,null,React.createElement(d.a,{as:"h3",icon:"search",content:Object(c.__)("Search for existing "+t)}),React.createElement(f.a,{placeholder:n?Object(c.__)("Loading "+t+"..."):Object(c.__)(r+"'s"),fluid:!0,search:!0,selection:!0,loading:n,disabled:n,options:a,onChange:function(e,n){var a=n.options.find((function(e){return e.value===n.value})),l=a.value,c=a.text;h(s,l,t,u).then((function(e){i({title:c,id:l,lastUpdated:e.modified_gmt})}))},style:{fontFamily:"Lato,'Helvetica Neue',Arial,Helvetica,sans-serif",fontSize:"14px"}}))})),g=Object(m.a)({title:""})((function(e){var t=e.title,n=e.postType,a=e.setState,l=e.setAttributes;return React.createElement(o.Fragment,null,React.createElement(d.a,{as:"h3",icon:"add",content:Object(c.__)("Start a new "+n)}),React.createElement(b.a,{onSubmit:function(){l({title:t,id:1})}},React.createElement(b.a.Group,null,React.createElement(b.a.Input,{placeholder:"Title",name:"title",value:t,onChange:function(e,t){t.name;var n=t.value;a({title:n})}}),React.createElement(b.a.Button,{color:"blue",icon:"add",content:Object(c.__)("Create "+n)}))))})),_=function(e){var t=e.postType,n=e.setAttributes,a=e.className,l=e.clientId;return React.createElement("div",{className:a},React.createElement(R.Card,{size:"large"},React.createElement(R.CardHeader,null,React.createElement(w,{postType:t,clientId:l,setAttributes:n})),React.createElement(R.CardBody,null,React.createElement(g,{postType:t,setAttributes:n}))))},O=function(e){var t=e.id,n=e.postType,a=e.title,s=e.lastUpdated,r=e.clientId,d=e.setAttributes,u=void 0!==d&&d,m=Object(E.useSelect)((function(e){return e("core/block-editor").getBlock(r)}),[]),f=Object(o.useState)(!1),b=Object(i.a)(f,2),w=b[0],g=b[1],_=y(n),O=Object(E.useDispatch)("core/block-editor").replaceInnerBlocks,j=function(e){var a=e.isSmall,l=void 0!==a&&a;return React.createElement(R.Button,{isSmall:l,isPrimary:!0,onClick:function(){h(r,t,n,O).then((function(e){u({lastUpdated:e.modified_gmt}),g(!1)}))}},Object(c.__)("Update Content"))},k=function(e){var t=e.isSmall,n=void 0!==t&&t,i=function(){var e,t,n=(e=m.attributes,t=m.innerBlocks,Object(l.getSaveContent)("sethrubenstein/ghost-block",e,t));new wp.api.models[_]({title:a,content:n}).save().then((function(e){u({id:e.id,lastUpdated:e.modified_gmt})}))};return React.createElement(R.Button,{isSmall:n,isSecondary:!0,onClick:function(){return i()}},Object(c.__)("Save As New "+_))},T=function(){(console.info("Watching for updates..."),1!==t)&&new wp.api.models[_]({id:t}).fetch().then((function(e){s!==e.modified_gmt&&g(!0)}))};Object(v.a)((function(){T(),setInterval(T,3e4)}));var S=_+" Settings";return React.createElement(o.Fragment,null,!0===w&&React.createElement("div",{style:{fontSize:"13px",fontFamily:"sans-serif",color:"gray",display:"flex",alignItems:"center"}},React.createElement(R.Dashicon,{icon:"update",style:{marginRight:"11px"}}),"This ",_," has updated content."),React.createElement("div",{style:{display:"flex"}},!0===w&&React.createElement("div",null,React.createElement(j,{isSmall:!0})),React.createElement("div",null,React.createElement(k,{isSmall:!0})),React.createElement("div",null,React.createElement(R.Button,{isSmall:!0,isLink:!0},Object(c.__)("Edit In New Window")))),React.createElement(p.InspectorControls,null,React.createElement(R.Panel,null,React.createElement(R.PanelBody,{title:Object(c.__)(S),initialOpen:!0},React.createElement(R.PanelRow,null,React.createElement(R.TextControl,{label:"Title",value:a,onChange:function(e){return u({title:e})}})),React.createElement(R.PanelRow,null,React.createElement(R.TextControl,{label:"ID",value:t,disabled:!0})),React.createElement(R.PanelRow,null,React.createElement(R.TextControl,{label:"Post Type",value:_,disabled:!0})),React.createElement(R.PanelRow,null,React.createElement(j,null)),React.createElement(R.PanelRow,null,React.createElement(k,null))))))},j=function(e){var t=e.id,n=e.postType,a=e.title,l=e.lastUpdated,c=e.clientId,i=e.setAttributes,s=void 0!==i&&i,r=e.className,d=void 0===r?"":r,u=e.allowedBlocks,m=void 0===u?null:u;return 0!==t?React.createElement(o.Fragment,null,!1!==s&&React.createElement(o.Fragment,null,React.createElement(p.InnerBlocks,{allowedBlocks:m}),React.createElement(O,{id:t,postType:n,title:a,lastUpdated:l,clientId:c,setAttributes:s})),!1===s&&React.createElement(p.InnerBlocks.Content,null)):React.createElement(_,{postType:n,setAttributes:s,className:d,clientId:c})},k=["easyteachlms/topic"],T=function(e){var t=e.attributes,n=e.className,a=e.clientId,l=e.setAttributes,c=t.id,i=t.lastUpdated,o=t.title;return 0!==c&&""!==o?React.createElement(u,{className:n,title:o,postType:"lesson"},React.createElement(j,{id:c,postType:"lesson",title:o,lastUpdated:i,setAttributes:l,allowedBlocks:k,clientId:a})):React.createElement(j,{id:c,postType:"lesson",title:o,lastUpdated:i,setAttributes:l,allowedBlocks:k,clientId:a})},S=function(e){var t=e.attributes,n=e.className,a=e.clientId,l=t.title,c=t.lastUpdated,i=t.id;return React.createElement("div",{className:n},React.createElement(j,{id:i,postType:"topic",title:l,lastUpdated:c,setAttributes:!1,clientId:a}))},I=["easyteachlms/lesson",{title:Object(c.__)("Lesson"),description:"Block Desc.",category:"education",keywords:[Object(c.__)("Key 1"),Object(c.__)("Key 2"),Object(c.__)("Key 3")],supports:{html:!1,align:!0},attributes:{id:{type:"integer",default:0},lastUpdated:{type:"string",default:""},title:{type:"string",default:""}},edit:T,save:S}];n(310);l.registerBlockType.apply(void 0,Object(a.a)(I))},48:function(e,t){e.exports=wp.blocks},61:function(e,t){e.exports=ReactDOM},62:function(e,t){e.exports=wp.blockEditor},63:function(e,t){e.exports=wp.data}},[[186,1,2]]]);
//# sourceMappingURL=block-7c724147.js.map